<?xml version="1.0"?>
<!--
/**
 * Copyright (c) <2013>, <Rugento.ru>
 * License URL http://www.rugento.ru/oferta.html
 * Support URL http://support.rugento.ru
 * Support EMAIL support@rugento.ru
 */
-->
<config>
    <modules>
        <Rugento_Smsnotice>
            <version>1.1.3</version>
        </Rugento_Smsnotice>
    </modules>
    <global>
        <models>
            <smsnotice>
                <class>Rugento_Smsnotice_Model</class>
                <resourceModel>smsnotice_mysql4</resourceModel>
            </smsnotice>
            <smsnotice_mysql4>
                <class>Rugento_Smsnotice_Model_Resource</class>
                <entities>
                    <queue>
                        <table>rugento_sms_queue</table>
                    </queue>
                    <customer>
                        <table>rugento_sms_customer</table>
                    </customer>
                </entities>
            </smsnotice_mysql4>
        </models>
        <resources>
            <smsnotice_setup>
                <setup>
                    <module>Rugento_Smsnotice</module>
                    <class>Mage_Eav_Model_Entity_Setup</class>
                </setup>
                <connection>
                    <use>core_setup</use>
                </connection>
            </smsnotice_setup>
            <smsnotice_write>
                <connection>
                    <use>core_write</use>
                </connection>
            </smsnotice_write>
            <smsnotice_read>
                <connection>
                    <use>core_read</use>
                </connection>
            </smsnotice_read>
        </resources>
        <helpers>
            <smsnotice>
                <class>Rugento_Smsnotice_Helper</class>
            </smsnotice>
        </helpers>
         <blocks>
            <smsnotice>
                <class>Rugento_Smsnotice_Block</class>
            </smsnotice>
        </blocks>
        <smsnotice>
            <operators>
                <smsdelivery>
                    <name>smsdelivery.ru</name>
                    <model>smsnotice/gateway_smsdeliveryru</model>
                </smsdelivery>
                <unisender>
                    <name>unisender.ru</name>
                    <model>smsnotice/gateway_unisenderru</model>
                </unisender>
                 <smsbliss>
                    <name>smsbliss.ru</name>
                    <model>smsnotice/gateway_smsblissru</model>
                </smsbliss>
                <turbosmsua>
                    <name>turbosms.ua</name>
                    <model>smsnotice/gateway_turbosmsua</model>
                </turbosmsua>
                <smsru>
                    <name>sms.ru</name>
                    <model>smsnotice/gateway_smsru</model>
                </smsru>
                 <log>
                    <name>&#x417;&#x430;&#x43F;&#x438;&#x441;&#x44C; &#x432; sms_adapter.log (&#x43E;&#x442;&#x43B;&#x430;&#x434;&#x43A;&#x430;)</name>
                    <model>smsnotice/gateway_log</model>
                </log>
            </operators>
            <event_codes>
                <event_order>
                    <name>&#x41E; &#x43D;&#x43E;&#x432;&#x43E;&#x43C; &#x437;&#x430;&#x43A;&#x430;&#x437;&#x435;</name>
                </event_order>
                <event_invoice>
                    <name>&#x41E; &#x43F;&#x43E;&#x441;&#x442;&#x443;&#x43F;&#x438;&#x432;&#x448;&#x435;&#x43C; &#x43F;&#x43B;&#x430;&#x442;&#x435;&#x436;&#x435;</name>
                </event_invoice>
                 <event_shipment>
                    <name>&#x41E;&#x431; &#x43E;&#x442;&#x43F;&#x440;&#x430;&#x432;&#x43A;&#x435; &#x437;&#x430;&#x43A;&#x430;&#x437;&#x430; &#x438; &#x43D;&#x43E;&#x43C;&#x435;&#x440; &#x43E;&#x442;&#x441;&#x43B;&#x435;&#x436;&#x438;&#x432;&#x430;&#x43D;&#x438;&#x44F;</name>
                </event_shipment>
                <event_order_cancel>
                    <name>&#x41E;&#x431; &#x43E;&#x442;&#x43C;&#x435;&#x43D;&#x435; &#x437;&#x430;&#x43A;&#x430;&#x437;&#x430;</name>
                </event_order_cancel>
            </event_codes>
        </smsnotice>
        <events>
            <sales_order_save_after>
                <observers>
                    <sales_order_save_after_send_sms>
                        <class>Rugento_Smsnotice_Model_Observer</class>
                        <method>sendOrderSms</method>
                    </sales_order_save_after_send_sms>
                </observers>
            </sales_order_save_after>
             <sales_order_invoice_save_after>
                <observers>
                    <sales_order_invoice_save_after_send_sms>
                        <class>Rugento_Smsnotice_Model_Observer</class>
                        <method>sendInvoiceSms</method>
                    </sales_order_invoice_save_after_send_sms>
                </observers>
            </sales_order_invoice_save_after>
            <sales_order_shipment_save_after>
                <observers>
                    <sales_order_shipment_save_after_send_sms>
                        <class>Rugento_Smsnotice_Model_Observer</class>
                        <method>sendShipmentAndTrackingSms</method>
                    </sales_order_shipment_save_after_send_sms>
                </observers>
            </sales_order_shipment_save_after>
             <customer_register_success>
                <observers>
                    <customer_register_success_add_sms>
                        <class>Rugento_Smsnotice_Model_Observer</class>
                        <method>subscribeCustomer</method>
                    </customer_register_success_add_sms>
                </observers>
            </customer_register_success>
        </events>
    </global>
    <admin>
        <routers>
            <smsnotice>
                <use>admin</use>
                <args>
                    <module>Rugento_Smsnotice</module>
                    <frontName>smsnotice</frontName>
                </args>
            </smsnotice>
        </routers>
    </admin>
    <frontend>
        <routers>
            <smsnotice>
                <use>standard</use>
                <args>
                    <module>Rugento_Smsnotice</module>
                    <frontName>smsnotice</frontName>
                </args>
            </smsnotice>
        </routers>
        <layout>
            <updates>
                <smsnotice>
                    <file>smsnotice/smsnotice.xml</file>
                </smsnotice>
            </updates>
        </layout>
    </frontend>
    <adminhtml>
         <menu>
              <smsnotice translate="title" module="smsnotice">
                <title>&#x421;&#x41C;&#x421; &#x443;&#x432;&#x435;&#x434;&#x43E;&#x43C;&#x43B;&#x435;&#x43D;&#x438;&#x44F;</title>
                <sort_order>81</sort_order>
               <children>
                    <queue_sms translate="title" module="smsnotice">
                        <title>&#x41E;&#x447;&#x435;&#x440;&#x435;&#x434;&#x44C; &#x441;&#x43C;&#x441; &#x441;&#x43E;&#x43E;&#x431;&#x449;&#x435;&#x43D;&#x438;&#x439;</title>
                        <action>smsnotice/adminhtml_queue</action>
                        <sort_order>10</sort_order>
                    </queue_sms>
                    <settings translate="title" module="smsnotice">
                        <title>&#x41D;&#x430;&#x441;&#x442;&#x440;&#x43E;&#x439;&#x43A;&#x438;</title>
                        <action>adminhtml/system_config/edit/section/rugento_smsnotice</action>
                        <sort_order>20</sort_order>
                    </settings>
                    <send_sms translate="title" module="smsnotice">
                        <title>&#x41E;&#x442;&#x43F;&#x440;&#x430;&#x432;&#x438;&#x442;&#x44C; &#x441;&#x43C;&#x441;</title>
                        <action>smsnotice/adminhtml_sms</action>
                        <sort_order>2</sort_order>
                    </send_sms>
                </children>
            </smsnotice>
        </menu>
        <translate>
            <modules>
                <Rugento_Smsnotice>
                    <files>
                        <Rugento_Smsnotice>smsnotice/Rugento_Smsnotice.csv</Rugento_Smsnotice>
                    </files>
                </Rugento_Smsnotice>
            </modules>
        </translate>
         <acl>
            <resources>
                <admin>
                    <children>
                        <system>
                            <children>
                                <config>
                                    <children>
                                        <rugento_smsnotice>
                                              <title>&#x423;&#x432;&#x435;&#x434;&#x43E;&#x43C;&#x43B;&#x435;&#x43D;&#x438;&#x44F; &#x43F;&#x43E; SMS</title>
                                        </rugento_smsnotice>
                                    </children>
                                </config>
                            </children>
                        </system>
                        <smsnotice translate="title" module="smsnotice">
                            <title>&#x423;&#x432;&#x435;&#x434;&#x43E;&#x43C;&#x43B;&#x435;&#x43D;&#x438;&#x44F; &#x43F;&#x43E; SMS</title>
                            <sort_order>100</sort_order>
                            <children>
                                <queue_sms translate="title">
                                    <title>&#x41E;&#x447;&#x435;&#x440;&#x435;&#x434;&#x44C; &#x441;&#x43C;&#x441; &#x441;&#x43E;&#x43E;&#x431;&#x449;&#x435;&#x43D;&#x438;&#x439;</title>
                                </queue_sms>
                            </children>
                        </smsnotice>
                    </children>
                </admin>
            </resources>
        </acl>
        <layout>
            <updates>
                <smsnotice>
                    <file>smsnotice/smsnotice.xml</file>
                </smsnotice>
            </updates>
        </layout>
    </adminhtml>
    <default>
        <rugento_smsnotice>
            <general>
                <admin_from_hour>8</admin_from_hour>
                <admin_to_hour>20</admin_to_hour>
                <user_from_hour>10</user_from_hour>
                <user_to_hour>20</user_to_hour>
            </general>
            <balance>
                <level>20</level>
            </balance>
            <other>
                <show_order_admin>1</show_order_admin>
                <eraselog>30</eraselog>
            </other>
        </rugento_smsnotice>
    </default>
    <crontab>
        <jobs>
            <rugento_smsnotice_sheduler>
                <schedule><cron_expr>*/5 * * * *</cron_expr></schedule>
                <run><model>smsnotice/sheduler::sendQueue</model></run>
            </rugento_smsnotice_sheduler>
            <rugento_smsnotice_sheduler_check>
                <schedule><cron_expr>*/30 * * * *</cron_expr></schedule>
                <run><model>smsnotice/sheduler::startCron</model></run>
            </rugento_smsnotice_sheduler_check>
            <rugento_smsnotice_sheduler_balance>
                <schedule><cron_expr>*/30 * * * *</cron_expr></schedule>
                <run><model>smsnotice/sheduler::checkBalance</model></run>
            </rugento_smsnotice_sheduler_balance>
        </jobs>
    </crontab>
</config>
