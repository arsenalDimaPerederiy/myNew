<?php
/**
 * Exotern
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0)
 * that is bundled with this package in the file LICENSE.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magentocommerce.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade the extension to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.exotern.com for more information or
 * send an email to support@exotern.com .
 *
 * @category    Exotern
 * @package     Exotern_Crumbs
 * @copyright   Copyright (c) 2013 Exotern (http://www.exotern.com)
 * @license     http://opensource.org/licenses/osl-3.0.php  Open Software License (OSL 3.0)
 */

$crumbsLevels = $this->getAllBreadcrumbs();
?>



<?php if($crumbsLevels && is_array($crumbsLevels)): ?>
	<?php if(Mage::registry('current_product')): ?>
		<div class="breadcrumbs-back">
			<a href="javascript: history.go(-1)"><?php echo $this->__('Back'); ?></a>
		</div>
		<div class="breadcrumbs">

				<?php foreach($crumbsLevels as $crumbs): ?>
					
					<?php foreach($crumbs as $_crumb): ?>		
						
						<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="crumb<?php if(isset($_crumb['category_id'])): echo $_crumb['category_id']; endif; ?>">
						<?php if(!empty($_crumb['link'])): ?>
							<a itemprop="url" href="<?php echo $_crumb['link'] ?>" title="<?php echo $this->htmlEscape($_crumb['title']) ?>"><span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span></a>
						<?php elseif($_crumb['last']): ?>
							<span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span>
						<?php else: ?>
							<span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span>
						<?php endif; ?>
						<?php if(!$_crumb['last']): ?>
							
						<?php endif; ?>
						</div>
						
					<?php endforeach; ?>

				<?php endforeach; ?>

		</div>

	<?php else: ?>
		<div class="breadcrumbs">

				<?php foreach($crumbsLevels as $crumbs): ?>
					
					<?php foreach($crumbs as $_crumb): ?>		
						
						<div itemscope itemtype="http://data-vocabulary.org/Breadcrumb" class="crumb<?php if(isset($_crumb['category_id'])): echo $_crumb['category_id']; endif; ?>">
						<?php if(!empty($_crumb['link'])): ?>
							<a itemprop="url" href="<?php echo $_crumb['link'] ?>" title="<?php echo $this->htmlEscape($_crumb['title']) ?>"><span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span></a>
						<?php elseif($_crumb['last']): ?>
							<span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span>
						<?php else: ?>
							<span itemprop="title"><?php echo $this->htmlEscape($_crumb['title']) ?></span>
						<?php endif; ?>
						<?php if(!$_crumb['last']): ?>
							
						<?php endif; ?>
						</div>
						
					<?php endforeach; ?>

				<?php endforeach; ?>

		</div>
		<div class="breadcrumbs-back">
			<a href="javascript: history.go(-1)"><?php echo $this->__('Back'); ?></a>
		</div>
	<?php endif; ?>
<?php endif; ?>

