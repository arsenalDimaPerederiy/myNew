(function($){jQuery.fn.dcAccordion=function(options){var defaults={classParent:'dcjq-parent',classActive:'active',classArrow:'dcjq-icon',classCount:'dcjq-count',classExpand:'dcjq-current-parent',eventType:'click',hoverDelay:300,menuClose:true,autoClose:true,autoExpand:false,speed:'slow',saveState:true,disableLink:true,showCount:false,cookie:'dcjq-accordion'};var options=jQuery.extend(defaults,options);this.each(function(options){var obj=this;setUpAccordion();if(defaults.saveState==true){checkCookie(defaults.cookie,obj)}if(defaults.autoExpand==true){jQuery('li.'+defaults.classExpand+' > a').addClass(defaults.classActive)}resetAccordion();if(defaults.eventType=='hover'){var config={sensitivity:2,interval:defaults.hoverDelay,over:linkOver,timeout:defaults.hoverDelay,out:linkOut};jQuery('li a',obj).hoverIntent(config);var configMenu={sensitivity:2,interval:1000,over:menuOver,timeout:1000,out:menuOut};jQuery(obj).hoverIntent(configMenu);if(defaults.disableLink==true){jQuery('li a',obj).click(function(e){if(jQuery(this).siblings('ul').length>0){e.preventDefault()}})}}else{jQuery('li a',obj).click(function(e){$activeLi=jQuery(this).parent('li');$parentsLi=$activeLi.parents('li');$parentsUl=$activeLi.parents('ul');if(defaults.disableLink==true){if(jQuery(this).siblings('ul').length>0){e.preventDefault()}}if(defaults.autoClose==true){autoCloseAccordion($parentsLi,$parentsUl)}if(jQuery('> ul',$activeLi).is(':visible')){jQuery('ul',$activeLi).slideUp(defaults.speed);jQuery('a',$activeLi).removeClass(defaults.classActive)}else{jQuery(this).siblings('ul').slideToggle(defaults.speed);jQuery('> a',$activeLi).addClass(defaults.classActive)}if(defaults.saveState==true){createCookie(defaults.cookie,obj)}})}function setUpAccordion(){$arrow='<span class="'+defaults.classArrow+'"></span>';var classParentLi=defaults.classParent+'-li';jQuery('> ul',obj).show();jQuery('li',obj).each(function(){if(jQuery('> ul',this).length>0){jQuery(this).addClass(classParentLi);jQuery('> a',this).addClass(defaults.classParent).append($arrow)}});jQuery('> ul',obj).hide();if(defaults.showCount==true){jQuery('li.'+classParentLi,obj).each(function(){if(defaults.disableLink==true){var getCount=parseInt(jQuery('ul a:not(.'+defaults.classParent+')',this).length)}else{var getCount=parseInt(jQuery('ul a',this).length)}jQuery('> a',this).append(' <span class="'+defaults.classCount+'">('+getCount+')</span>')})}}function linkOver(){$activeLi=jQuery(this).parent('li');$parentsLi=$activeLi.parents('li');$parentsUl=$activeLi.parents('ul');if(defaults.autoClose==true){autoCloseAccordion($parentsLi,$parentsUl)}if(jQuery('> ul',$activeLi).is(':visible')){jQuery('ul',$activeLi).slideUp(defaults.speed);jQuery('a',$activeLi).removeClass(defaults.classActive)}else{jQuery(this).siblings('ul').slideToggle(defaults.speed);jQuery('> a',$activeLi).addClass(defaults.classActive)}if(defaults.saveState==true){createCookie(defaults.cookie,obj)}}function linkOut(){}function menuOver(){}function menuOut(){if(defaults.menuClose==true){jQuery('ul',obj).slideUp(defaults.speed);jQuery('a',obj).removeClass(defaults.classActive);createCookie(defaults.cookie,obj)}}function autoCloseAccordion($parentsLi,$parentsUl){jQuery('ul',obj).not($parentsUl).slideUp(defaults.speed);jQuery('a',obj).removeClass(defaults.classActive);jQuery('> a',$parentsLi).addClass(defaults.classActive)}function resetAccordion(){jQuery('ul',obj).hide();$allActiveLi=jQuery('a.'+defaults.classActive,obj);$allActiveLi.siblings('ul').show()}});function checkCookie(cookieId,obj){var cookieVal=jQuery.cookie(cookieId);if(cookieVal!=null){var activeArray=cookieVal.split(',');jQuery.each(activeArray,function(index,value){var $cookieLi=jQuery('li:eq('+value+')',obj);jQuery('> a',$cookieLi).addClass(defaults.classActive);var $parentsLi=$cookieLi.parents('li');jQuery('> a',$parentsLi).addClass(defaults.classActive)})}}function createCookie(cookieId,obj){var activeIndex=[];jQuery('li a.'+defaults.classActive,obj).each(function(i){var $arrayItem=jQuery(this).parent('li');var itemIndex=jQuery('li',obj).index($arrayItem);activeIndex.push(itemIndex)});jQuery.cookie(cookieId,activeIndex,{path:'/'})}}})(jQuery);
